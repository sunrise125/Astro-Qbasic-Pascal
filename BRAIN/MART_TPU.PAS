 Unit MART_TPU;    {Unit… per Calcolo Marte di PRECISIONE}

 Interface

 Uses Crt;
 Const
       Ko=0.00000001; rad=pi/180;
 Var
       i                : Integer;
       tau,so,L,L0,L1,L2,L3,L4,L5,
              B,B0,B1,B2,B3,B4,
              R,R0,R1,R2,R3,R4,
       teta,beta,Xecl,Yecl,Zecl,EPSdata,zita,Z,
       XS,YS,ZS, XS1,YS1,ZS1, XSD,YSD,ZSD  : Real;

   Procedure MAR(tau:Real;Var L,B,R: Real);
   Procedure CaricamentoDatiLONG(tau:Real; VAR L,B,R:Real);
   Procedure CaricamentoDatiLAT(tau:Real; VAR L,B,R:Real);
   Procedure CaricamentoDatiRAGGIO(tau:Real; VAR L,B,R:Real);
      Function ArcoTANG(num,den:Real): Real;
      Function ArcoSIN(valore:Real): Real;
      Function MODULO(x,y:Real) : Real;

 Implementation

      Function ArcoTANG(num,den:Real): Real;
    Var atan: Real;
   Begin
     atan:=arctan(num/den);
      if den<0 then atan:=atan+pi;
      if atan<0 then atan:=atan+2*pi;
     ArcoTANG:=atan;
  End;

      Function ArcoSIN(valore:Real): Real;
   Begin
     ArcoSIN:=arctan(valore/SQRT(1-valore*valore));
  End;

      Function MODULO(x,y:Real) : Real;
   Var modu : Real;
   Begin
     modu:=(x/y-INT(x/y))*y;
     MODULO:=modu;
  End;

   Procedure CaricamentoDatiLONG(tau:Real; VAR L,B,R:Real);
Const
       Ku=0.00001;
       l0m=69; l1m=46; l2m=33; l3m=12; l4m=8; l5m=2;
Var
       L0A:           Array[1..l0m] of LongInt;
       L0B,L0C:       Array[1..l0m] of Real;
       L1A:           Array[1..l1m] of Real;
       L1B,L1C:       Array[1..l1m] of Real;
       L2A:           Array[1..l2m] of LongInt;
       L2B,L2C:       Array[1..l2m] of Real;
       L3A:           Array[1..l3m] of Integer;
       L3B,L3C:       Array[1..l3m] of Real;
       L4A:           Array[1..l4m] of Integer;
       L4B,L4C:       Array[1..l4m] of Real;
       L5A:           Array[1..l5m] of Integer;
       L5B,L5C:       Array[1..l5m] of Real;
 begin

    L0A[1]:=620347712;        L0B[1]:=0;              L0C[1]:=0;
    L0A[2]:= 18656368;        L0B[2]:=5.05037100;     L0C[2]:=3340.61242670;
    L0A[3]:=  1108217;        L0B[3]:=5.4009984;      L0C[3]:=6681.2248534;
    L0A[4]:=    91798;        L0B[4]:=5.75479;        L0C[4]:=10021.83728;
    L0A[5]:=    27745;        L0B[5]:=5.97050;        L0C[5]:=3.52312;
    L0A[6]:=    12316;        L0B[6]:=0.84956;        L0C[6]:=2810.92146;
    L0A[7]:=    10610;        L0B[7]:=2.93959;        L0C[7]:=2281.23050;
    L0A[8]:=     8927;        L0B[8]:=4.1570;         L0C[8]:=0.0173;
    L0A[9]:=     8716;        L0B[9]:=6.1101;         L0C[9]:=13362.4497;
   L0A[10]:=     7775;       L0B[10]:=3.3397;        L0C[10]:=5621.8429;
   L0A[11]:=     6798;       L0B[11]:=0.3646;        L0C[11]:=398.1490;
   L0A[12]:=     4161;       L0B[12]:=0.2281;        L0C[12]:=2942.4634;
   L0A[13]:=     3575;       L0B[13]:=1.6619;        L0C[13]:=2544.3144;
   L0A[14]:=     3075;       L0B[14]:=0.8570;        L0C[14]:=191.4483;
   L0A[15]:=     2938;       L0B[15]:=6.0789;        L0C[15]:=0.0673;
   L0A[16]:=     2628;       L0B[16]:=0.6481;        L0C[16]:=3337.0893;
   L0A[17]:=     2580;       L0B[17]:=0.0300;        L0C[17]:=3344.1355;
   L0A[18]:=     2389;       L0B[18]:=5.0390;        L0C[18]:=796.2980;
   L0A[19]:=     1799;       L0B[19]:=0.6563;        L0C[19]:=529.6910;
   L0A[20]:=     1546;       L0B[20]:=2.9158;        L0C[20]:=1751.5395;
   L0A[21]:=     1528;       L0B[21]:=1.1498;        L0C[21]:=6151.5339;
   L0A[22]:=     1286;       L0B[22]:=3.0680;        L0C[22]:=2146.1654;
   L0A[23]:=     1264;       L0B[23]:=3.6228;        L0C[23]:=5092.1520;
   L0A[24]:=     1025;       L0B[24]:=3.6933;        L0C[24]:=8962.4553;
   L0A[25]:=      892;       L0B[25]:=0.183;         L0C[25]:=16703.062;
   L0A[26]:=      859;       L0B[26]:=2.401;         L0C[26]:=2914.014;
   L0A[27]:=      833;       L0B[27]:=4.495;         L0C[27]:=3340.630;
   L0A[28]:=      833;       L0B[28]:=2.464;         L0C[28]:=3340.595;
   L0A[29]:=      749;       L0B[29]:=3.822;         L0C[29]:=155.420;
   L0A[30]:=      724;       L0B[30]:=0.675;         L0C[30]:=3738.761;
   L0A[31]:=      713;       L0B[31]:=3.663;         L0C[31]:=1059.382;
   L0A[32]:=      655;       L0B[32]:=0.489;         L0C[32]:=3127.313;
   L0A[33]:=      636;       L0B[33]:=2.922;         L0C[33]:=8432.764;
   L0A[34]:=      553;       L0B[34]:=4.475;         L0C[34]:=1748.016;
   L0A[35]:=      550;       L0B[35]:=3.810;         L0C[35]:=0.980;
   L0A[36]:=      472;       L0B[36]:=3.625;         L0C[36]:=1194.447;
   L0A[37]:=      426;       L0B[37]:=0.554;         L0C[37]:=6283.076;
   L0A[38]:=      415;       L0B[38]:=0.497;         L0C[38]:=213.299;
   L0A[39]:=      312;       L0B[39]:=0.999;         L0C[39]:=6677.702;
   L0A[40]:=      307;       L0B[40]:=0.381;         L0C[40]:=6684.748;
   L0A[41]:=      302;       L0B[41]:=4.486;         L0C[41]:=3532.061;
   L0A[42]:=      299;       L0B[42]:=2.783;         L0C[42]:=6254.627;
   L0A[43]:=      293;       L0B[43]:=4.221;         L0C[43]:=20.775;
   L0A[44]:=      284;       L0B[44]:=5.769;         L0C[44]:=3149.164;
   L0A[45]:=      281;       L0B[45]:=5.882;         L0C[45]:=1349.867;
   L0A[46]:=      274;       L0B[46]:=0.542;         L0C[46]:=3340.545;
   L0A[47]:=      274;       L0B[47]:=0.134;         L0C[47]:=3340.680;
   L0A[48]:=      239;       L0B[48]:=5.372;         L0C[48]:=4136.910;
   L0A[49]:=      236;       L0B[49]:=5.755;         L0C[49]:=3333.499;
   L0A[50]:=      231;       L0B[50]:=1.282;         L0C[50]:=3870.303;
   L0A[51]:=      221;       L0B[51]:=3.505;         L0C[51]:=382.897;
   L0A[52]:=      204;       L0B[52]:=2.821;         L0C[52]:=1221.849;
   L0A[53]:=      193;       L0B[53]:=3.357;         L0C[53]:=3.590;
   L0A[54]:=      189;       L0B[54]:=1.491;         L0C[54]:=9492.146;
   L0A[55]:=      179;       L0B[55]:=1.006;         L0C[55]:=951.718;
   L0A[56]:=      174;       L0B[56]:=2.414;         L0C[56]:=553.569;
   L0A[57]:=      172;       L0B[57]:=0.439;         L0C[57]:=5486.778;
   L0A[58]:=      160;       L0B[58]:=3.949;         L0C[58]:=4562.461;
   L0A[59]:=      144;       L0B[59]:=1.419;         L0C[59]:=135.065;
   L0A[60]:=      140;       L0B[60]:=3.326;         L0C[60]:=2700.715;
   L0A[61]:=      138;       L0B[61]:=4.301;         L0C[61]:=7.114;
   L0A[62]:=      131;       L0B[62]:=4.045;         L0C[62]:=12303.068;
   L0A[63]:=      128;       L0B[63]:=2.208;         L0C[63]:=1592.596;
   L0A[64]:=      128;       L0B[64]:=1.807;         L0C[64]:=5088.629;
   L0A[65]:=      117;       L0B[65]:=3.128;         L0C[65]:=7903.073;
   L0A[66]:=      113;       L0B[66]:=3.701;         L0C[66]:=1589.073;
   L0A[67]:=      110;       L0B[67]:=1.052;         L0C[67]:=242.729;
   L0A[68]:=      105;       L0B[68]:=0.785;         L0C[68]:=8827.390;
   L0A[69]:=      100;       L0B[69]:=3.243;         L0C[69]:=11773.377;

    so:=0; FOR i:= 1 to l0m do
     begin
     so:=so+Ko*L0A[i]*(COS(L0B[i]+L0C[i]*tau));
     end;  L0:=so;
 {----------------------------------------------------------------------------}
    L1A[1]:=334085627.474;    L1B[1]:=0;              L1C[1]:=0;
    L1A[2]:=     1458.227;    L1B[2]:=3.6042605;      L1C[2]:=3340.6124267;
    L1A[3]:=      164.901;    L1B[3]:=3.926313;       L1C[3]:=6681.224853;
    L1A[4]:=       19.963;    L1B[4]:=4.26594;        L1C[4]:=10021.83728;
    L1A[5]:=        3.452;    L1B[5]:=4.7321;         L1C[5]:=3.5231;
    L1A[6]:=        2.485;    L1B[6]:=4.6128;         L1C[6]:=13362.4497;
    L1A[7]:=        0.842;    L1B[7]:=4.459;          L1C[7]:=2281.230;
    L1A[8]:=        0.538;    L1B[8]:=5.016;          L1C[8]:=398.149;
    L1A[9]:=        0.521;    L1B[9]:=4.994;          L1C[9]:=3344.136;
   L1A[10]:=        0.433;   L1B[10]:=2.561;         L1C[10]:=191.448;
   L1A[11]:=        0.430;   L1B[11]:=5.316;         L1C[11]:=155.420;
   L1A[12]:=        0.382;   L1B[12]:=3.539;         L1C[12]:=796.298;
   L1A[13]:=        0.314;   L1B[13]:=4.963;         L1C[13]:=16703.062;
   L1A[14]:=        0.283;   L1B[14]:=3.160;         L1C[14]:=2544.314;
   L1A[15]:=        0.206;   L1B[15]:=4.569;         L1C[15]:=2146.165;
   L1A[16]:=        0.169;   L1B[16]:=1.329;         L1C[16]:=3337.089;
   L1A[17]:=        0.158;   L1B[17]:=4.185;         L1C[17]:=1751.540;
   L1A[18]:=        0.134;   L1B[18]:=2.233;         L1C[18]:=0.980;
   L1A[19]:=        0.134;   L1B[19]:=5.974;         L1C[19]:=1748.016;
   L1A[20]:=        0.118;   L1B[20]:=6.024;         L1C[20]:=6151.534;
   L1A[21]:=        0.117;   L1B[21]:=2.213;         L1C[21]:=1059.382;
   L1A[22]:=        0.114;   L1B[22]:=2.129;         L1C[22]:=1194.447;
   L1A[23]:=        0.114;   L1B[23]:=5.428;         L1C[23]:=3738.761;
   L1A[24]:=        0.091;   L1B[24]:=1.10;          L1C[24]:=1349.87;
   L1A[25]:=        0.085;   L1B[25]:=3.91;          L1C[25]:=553.57;
   L1A[26]:=        0.083;   L1B[26]:=5.30;          L1C[26]:=6684.75;
   L1A[27]:=        0.081;   L1B[27]:=4.43;          L1C[27]:=529.69;
   L1A[28]:=        0.080;   L1B[28]:=2.25;          L1C[28]:=8962.46;
   L1A[29]:=        0.073;   L1B[29]:=2.50;          L1C[29]:=951.72;
   L1A[30]:=        0.073;   L1B[30]:=5.84;          L1C[30]:=242.73;
   L1A[31]:=        0.071;   L1B[31]:=3.86;          L1C[31]:=2914.01;
   L1A[32]:=        0.068;   L1B[32]:=5.02;          L1C[32]:=382.90;
   L1A[33]:=        0.065;   L1B[33]:=1.02;          L1C[33]:=3340.60;
   L1A[34]:=        0.065;   L1B[34]:=3.05;          L1C[34]:=3340.63;
   L1A[35]:=        0.062;   L1B[35]:=4.15;          L1C[35]:=3149.16;
   L1A[36]:=        0.057;   L1B[36]:=3.89;          L1C[36]:=4136.91;
   L1A[37]:=        0.048;   L1B[37]:=4.87;          L1C[37]:=213.30;
   L1A[38]:=        0.048;   L1B[38]:=1.18;          L1C[38]:=3333.50;
   L1A[39]:=        0.047;   L1B[39]:=1.31;          L1C[39]:=3185.19;
   L1A[40]:=        0.041;   L1B[40]:=0.71;          L1C[40]:=1592.60;
   L1A[41]:=        0.040;   L1B[41]:=2.73;          L1C[41]:=7.11;
   L1A[42]:=        0.040;   L1B[42]:=5.32;          L1C[42]:=20043.67;
   L1A[43]:=        0.033;   L1B[43]:=5.41;          L1C[43]:=6283.08;
   L1A[44]:=        0.028;   L1B[44]:=0.05;          L1C[44]:=9492.146;
   L1A[45]:=        0.027;   L1B[45]:=3.89;          L1C[45]:=1221.85;
   L1A[46]:=        0.027;   L1B[46]:=5.11;          L1C[46]:=2700.72;

    so:=0; FOR i:= 1 to l1m do
     begin
     so:=so+Ku*L1A[i]*(COS(L1B[i]+L1C[i]*tau));
     end;  L1:=so;
 {----------------------------------------------------------------------------}
    L2A[1]:=58016;            L2B[1]:=2.04979;        L2C[1]:=3340.61243;
    L2A[2]:=54188;            L2B[2]:=0;              L2C[2]:=0;
    L2A[3]:=13908;            L2B[3]:=2.45742;        L2C[3]:=6681.22485;
    L2A[4]:= 2465;            L2B[4]:=2.8000;         L2C[4]:=10021.8373;
    L2A[5]:=  398;            L2B[5]:=3.141;          L2C[5]:=13362.450;
    L2A[6]:=  222;            L2B[6]:=3.194;          L2C[6]:=3.523;
    L2A[7]:=  121;            L2B[7]:=0.543;          L2C[7]:=155.420;
    L2A[8]:=   62;            L2B[8]:=3.49;           L2C[8]:=16703.06;
    L2A[9]:=   54;            L2B[9]:=3.54;           L2C[9]:=3344.14;
   L2A[10]:=   34;           L2B[10]:=6.00;          L2C[10]:=2281.23;
   L2A[11]:=   32;           L2B[11]:=4.14;          L2C[11]:=191.45;
   L2A[12]:=   30;           L2B[12]:=2.00;          L2C[12]:=796.30;
   L2A[13]:=   23;           L2B[13]:=4.33;          L2C[13]:=242.73;
   L2A[14]:=   22;           L2B[14]:=3.45;          L2C[14]:=398.15;
   L2A[15]:=   20;           L2B[15]:=5.42;          L2C[15]:=553.57;
   L2A[16]:=   16;           L2B[16]:=0.66;          L2C[16]:=0.98;
   L2A[17]:=   16;           L2B[17]:=6.11;          L2C[17]:=2146.17;
   L2A[18]:=   16;           L2B[18]:=1.22;          L2C[18]:=1748.02;
   L2A[19]:=   15;           L2B[19]:=6.10;          L2C[19]:=3185.19;
   L2A[20]:=   14;           L2B[20]:=4.02;          L2C[20]:=951.72;
   L2A[21]:=   14;           L2B[21]:=2.62;          L2C[21]:=1349.87;
   L2A[22]:=   13;           L2B[22]:=0.60;          L2C[22]:=1194.45;
   L2A[23]:=   12;           L2B[23]:=3.86;          L2C[23]:=6684.75;
   L2A[24]:=   11;           L2B[24]:=4.72;          L2C[24]:=2544.31;
   L2A[25]:=   10;           L2B[25]:=0.25;          L2C[25]:=382.90;
   L2A[26]:=    9;           L2B[26]:=0.68;          L2C[26]:=1059.38;
   L2A[27]:=    9;           L2B[27]:=3.83;          L2C[27]:=20043.67;
   L2A[28]:=    9;           L2B[28]:=3.88;          L2C[28]:=3738.76;
   L2A[29]:=    8;           L2B[29]:=5.46;          L2C[29]:=1751.54;
   L2A[30]:=    7;           L2B[30]:=2.58;          L2C[30]:=3149.16;
   L2A[31]:=    7;           L2B[31]:=2.38;          L2C[31]:=4136.91;
   L2A[32]:=    6;           L2B[32]:=5.48;          L2C[32]:=1592.60;
   L2A[33]:=    6;           L2B[33]:=2.34;          L2C[33]:=3097.88;

    so:=0; FOR i:= 1 to l2m do
     begin
     so:=so+Ko*L2A[i]*(COS(L2B[i]+L2C[i]*tau));
     end;  L2:=so;
 {----------------------------------------------------------------------------}
    L3A[1]:=1482;             L3B[1]:=0.4443;         L3C[1]:=3340.6124;
    L3A[2]:= 662;             L3B[2]:=0.885;          L3C[2]:=6681.225;
    L3A[3]:= 188;             L3B[3]:=1.288;          L3C[3]:=10021.837;
    L3A[4]:=  41;             L3B[4]:=1.65;           L3C[4]:=13362.45;
    L3A[5]:=  26;             L3B[5]:=0;              L3C[5]:=0;
    L3A[6]:=  23;             L3B[6]:=2.05;           L3C[6]:=155.42;
    L3A[7]:=  10;             L3B[7]:=1.58;           L3C[7]:=3.52;
    L3A[8]:=   8;             L3B[8]:=2.00;           L3C[8]:=16703.06;
    L3A[9]:=   5;             L3B[9]:=2.82;           L3C[9]:=242.73;
   L3A[10]:=   4;            L3B[10]:=2.02;          L3C[10]:=3344.14;
   L3A[11]:=   3;            L3B[11]:=4.59;          L3C[11]:=3185.19;
   L3A[12]:=   3;            L3B[12]:=0.65;          L3C[12]:=553.57;

    so:=0; FOR i:= 1 to l3m do
     begin
     so:=so+Ko*L3A[i]*(COS(L3B[i]+L3C[i]*tau));
     end;  L3:=so;
 {----------------------------------------------------------------------------}
    L4A[1]:=114;              L4B[1]:=3.1416;         L4C[1]:=0;
    L4A[2]:= 29;              L4B[2]:=5.64;           L4C[2]:=6681.22;
    L4A[3]:= 24;              L4B[3]:=5.14;           L4C[3]:=3340.61;
    L4A[4]:= 11;              L4B[4]:=6.03;           L4C[4]:=10021.84;
    L4A[5]:=  3;              L4B[5]:=0.13;           L4C[5]:=13362.45;
    L4A[6]:=  3;              L4B[6]:=3.56;           L4C[6]:=155.42;
    L4A[7]:=  1;              L4B[7]:=0.49;           L4C[7]:=16703.06;
    L4A[8]:=  1;              L4B[8]:=1.32;           L4C[8]:=242.73;

    so:=0; FOR i:= 1 to l4m do
     begin
     so:=so+Ko*L4A[i]*(COS(L4B[i]+L4C[i]*tau));
     end;  L4:=so;
 {----------------------------------------------------------------------------}
    L5A[1]:=1;                L5B[1]:=3.14;           L5C[1]:=0;
    L5A[2]:=1;                L5B[2]:=4.04;           L5C[2]:=6681.22;

    so:=0; FOR i:= 1 to l5m do
     begin
     so:=so+Ko*L5A[i]*(COS(L5B[i]+L5C[i]*tau));
     end;  L5:=so;
 {----------------------------------------------------------------------------}

    L:=((((L5*tau+L4)*tau+L3)*tau+L2)*tau+L1)*tau+L0;
    end;

   Procedure CaricamentoDatiLAT(tau:Real; VAR L,B,R:Real);
 Const
       b0m=16 ; b1m=9 ; b2m=7 ; b3m=4; b4m=3;
 Var
       B0A:           Array[1..B0m] of LongInt;
       B0B,B0C:       Array[1..B0m] of Real;
       B1A:           Array[1..B1m] of LongInt;
       B1B,B1C:       Array[1..B1m] of Real;
       B2A:           Array[1..B2m] of Integer;
       B2B,B2C:       Array[1..B2m] of Real;
       B3A:           Array[1..B3m] of Integer;
       B3B,B3C:       Array[1..B3m] of Real;
       B4A:           Array[1..B4m] of Integer;
       B4B,B4C:       Array[1..B4m] of Real;

  begin

    B0A[1]:=3197135;          B0B[1]:=3.7683204;      B0C[1]:=3340.6124267;
    B0A[2]:= 298033;          B0B[2]:=4.106170;       B0C[2]:=6681.224853;
    B0A[3]:= 289105;          B0B[3]:=0;              B0C[3]:=0;
    B0A[4]:=  31366;          B0B[4]:=4.44651;        B0C[4]:=10021.83728;
    B0A[5]:=   3484;          B0B[5]:=4.7881;         B0C[5]:=13362.4497;
    B0A[6]:=    443;          B0B[6]:=5.026;          B0C[6]:=3344.136;
    B0A[7]:=    443;          B0B[7]:=5.652;          B0C[7]:=3337.089;
    B0A[8]:=    399;          B0B[8]:=5.131;          B0C[8]:=16703.062;
    B0A[9]:=    293;          B0B[9]:=3.793;          B0C[9]:=2281.230;
   B0A[10]:=    182;         B0B[10]:=6.136;         B0C[10]:=6151.534;
   B0A[11]:=    163;         B0B[11]:=4.264;         B0C[11]:=529.691;
   B0A[12]:=    160;         B0B[12]:=2.232;         B0C[12]:=1059.382;
   B0A[13]:=    149;         B0B[13]:=2.165;         B0C[13]:=5621.843;
   B0A[14]:=    143;         B0B[14]:=1.182;         B0C[14]:=3340.595;
   B0A[15]:=    143;         B0B[15]:=3.213;         B0C[15]:=3340.630;
   B0A[16]:=    139;         B0B[16]:=2.418;         B0C[16]:=8962.455;

    so:=0; FOR i:= 1 to B0m do
     begin
     so:=so+Ko*B0A[i]*(COS(B0B[i]+B0C[i]*tau));
     end;  B0:=so;
 {----------------------------------------------------------------------------}
    B1A[1]:=350069;           B1B[1]:=5.368478;       B1C[1]:=3340.612427;
    B1A[2]:= 14116;           B1B[2]:=3.14159;        B1C[2]:=0;
    B1A[3]:=  9671;           B1B[3]:=5.4788;         B1C[3]:=6681.2249;
    B1A[4]:=  1472;           B1B[4]:=3.2021;         B1C[4]:=10021.8373;
    B1A[5]:=   426;           B1B[5]:=3.408;          B1C[5]:=13362.450;
    B1A[6]:=   102;           B1B[6]:=0.776;          B1C[6]:=3337.089;
    B1A[7]:=    79;           B1B[7]:=3.72;           B1C[7]:=16703.06;
    B1A[8]:=    33;           B1B[8]:=3.46;           B1C[8]:=5621.84;
    B1A[9]:=    26;           B1B[9]:=2.48;           B1C[9]:=2281.23;

    so:=0; FOR i:= 1 to B1m do
     begin
     so:=so+Ko*B1A[i]*(COS(B1B[i]+B1C[i]*tau));
     end;  B1:=so;
 {----------------------------------------------------------------------------}
    B2A[1]:=16727;            B2B[1]:=0.60221;        B2C[1]:=3340.61243;
    B2A[2]:= 4987;            B2B[2]:=3.1416;         B2C[2]:=0;
    B2A[3]:=  302;            B2B[3]:=3.559;          B2C[3]:=6681.225;
    B2A[4]:=   26;            B2B[4]:=1.90;           B2C[4]:=13362.45;
    B2A[5]:=   21;            B2B[5]:=0.92;           B2C[5]:=10021.84;
    B2A[6]:=   12;            B2B[6]:=2.24;           B2C[6]:=3337.09;
    B2A[7]:=    8;            B2B[7]:=2.25;           B2C[7]:=16703.06;

    so:=0; FOR i:= 1 to B2m do
     begin
     so:=so+Ko*B2A[i]*(COS(B2B[i]+B2C[i]*tau));
     end;  B2:=so;
 {----------------------------------------------------------------------------}
    B3A[1]:=607;              B3B[1]:=1.981;          B3C[1]:=3340.612;
    B3A[2]:= 43;              B3B[2]:=0;              B3C[2]:=0;
    B3A[3]:= 14;              B3B[3]:=1.80;           B3C[3]:=6681.22;
    B3A[4]:=  3;              B3B[4]:=3.45;           B3C[4]:=10021.84;

    so:=0; FOR i:= 1 to B3m do
     begin
     so:=so+Ko*B3A[i]*(COS(B3B[i]+B3C[i]*tau));
     end;  B3:=so;
 {----------------------------------------------------------------------------}
    B4A[1]:=13;               B4B[1]:=0;              B4C[1]:=0;
    B4A[2]:=11;               B4B[2]:=3.46;           B4C[2]:=3340.61;
    B4A[3]:= 1;               B4B[3]:=0.50;           B4C[3]:=6681.22;

    so:=0; FOR i:= 1 to B4m do
     begin
     so:=so+Ko*B4A[i]*(COS(B4B[i]+B4C[i]*tau));
     end;  B4:=so;
 {----------------------------------------------------------------------------}

    B:=(((B4*tau+B3)*tau+B2)*tau+B1)*tau+B0;
    end;


   Procedure CaricamentoDatiRAGGIO(tau:Real; VAR L,B,R:Real);
 Const
       r0m=45; r1m=27; r2m=11 ; r3m=6; r4m=4;
 Var
       R0A:           Array[1..R0m] of LongInt;
       R0B,R0C:       Array[1..R0m] of Real;
       R1A:           Array[1..R1m] of LongInt;
       R1B,R1C:       Array[1..R1m] of Real;
       R2A:           Array[1..R2m] of LongInt;
       R2B,R2C:       Array[1..R2m] of Real;
       R3A:           Array[1..R3m] of Integer;
       R3B,R3C:       Array[1..R3m] of Real;
       R4A:           Array[1..R4m] of Integer;
       R4B,R4C:       Array[1..R4m] of Real;

    begin

    R0A[1]:=153033488;        R0B[1]:=0;              R0C[1]:=0;
    R0A[2]:= 14184953;        R0B[2]:=3.47971284;     R0C[2]:=3340.61242670;
    R0A[3]:=   660776;        R0B[3]:=3.817834;       R0C[3]:=6681.224853;
    R0A[4]:=    46179;        R0B[4]:=4.15595;        R0C[4]:=10021.83728;
    R0A[5]:=     8110;        R0B[5]:=5.5596;         R0C[5]:=2810.9215;
    R0A[6]:=     7485;        R0B[6]:=1.7724;         R0C[6]:=5621.8429;
    R0A[7]:=     5523;        R0B[7]:=1.3644;         R0C[7]:=2281.2305;
    R0A[8]:=     3825;        R0B[8]:=4.4941;         R0C[8]:=13362.4497;
    R0A[9]:=     2484;        R0B[9]:=4.9255;         R0C[9]:=2942.4634;
   R0A[10]:=     2307;       R0B[10]:=0.0908;        R0C[10]:=2544.3144;
   R0A[11]:=     1999;       R0B[11]:=5.3606;        R0C[11]:=3337.0893;
   R0A[12]:=     1960;       R0B[12]:=4.7425;        R0C[12]:=3344.1355;
   R0A[13]:=     1167;       R0B[13]:=2.1126;        R0C[13]:=5092.1520;
   R0A[14]:=     1103;       R0B[14]:=5.0091;        R0C[14]:=398.1490;
   R0A[15]:=      992;       R0B[15]:=5.839;         R0C[15]:=6151.534;
   R0A[16]:=      899;       R0B[16]:=4.408;         R0C[16]:=529.691;
   R0A[17]:=      807;       R0B[17]:=2.102;         R0C[17]:=1059.382;
   R0A[18]:=      798;       R0B[18]:=3.448;         R0C[18]:=796.298;
   R0A[19]:=      741;       R0B[19]:=1.499;         R0C[19]:=2146.165;
   R0A[20]:=      726;       R0B[20]:=1.245;         R0C[20]:=8432.764;
   R0A[21]:=      692;       R0B[21]:=2.134;         R0C[21]:=8962.455;
   R0A[22]:=      633;       R0B[22]:=0.894;         R0C[22]:=3340.595;
   R0A[23]:=      633;       R0B[23]:=2.924;         R0C[23]:=3340.630;
   R0A[24]:=      630;       R0B[24]:=1.287;         R0C[24]:=1751.540;
   R0A[25]:=      574;       R0B[25]:=0.829;         R0C[25]:=2914.014;
   R0A[26]:=      526;       R0B[26]:=5.383;         R0C[26]:=3738.761;
   R0A[27]:=      473;       R0B[27]:=5.199;         R0C[27]:=3127.313;
   R0A[28]:=      348;       R0B[28]:=4.832;         R0C[28]:=16703.062;
   R0A[29]:=      284;       R0B[29]:=2.907;         R0C[29]:=3532.061;
   R0A[30]:=      280;       R0B[30]:=5.257;         R0C[30]:=6283.076;
   R0A[31]:=      276;       R0B[31]:=1.218;         R0C[31]:=6254.627;
   R0A[32]:=      275;       R0B[32]:=2.908;         R0C[32]:=1748.016;
   R0A[33]:=      270;       R0B[33]:=3.764;         R0C[33]:=5884.927;
   R0A[34]:=      239;       R0B[34]:=2.037;         R0C[34]:=1194.447;
   R0A[35]:=      234;       R0B[35]:=5.105;         R0C[35]:=5486.778;
   R0A[36]:=      228;       R0B[36]:=3.255;         R0C[36]:=6872.673;
   R0A[37]:=      223;       R0B[37]:=4.199;         R0C[37]:=3149.164;
   R0A[38]:=      219;       R0B[38]:=5.583;         R0C[38]:=191.448;
   R0A[39]:=      208;       R0B[39]:=5.255;         R0C[39]:=3340.545;
   R0A[40]:=      208;       R0B[40]:=4.846;         R0C[40]:=3340.680;
   R0A[41]:=      186;       R0B[41]:=5.699;         R0C[41]:=6677.702;
   R0A[42]:=      183;       R0B[42]:=5.081;         R0C[42]:=6684.748;
   R0A[43]:=      179;       R0B[43]:=4.184;         R0C[43]:=3333.499;
   R0A[44]:=      176;       R0B[44]:=5.953;         R0C[44]:=3870.303;
   R0A[45]:=      164;       R0B[45]:=3.799;         R0C[45]:=4136.910;

    so:=0; FOR i:= 1 to R0m do
     begin
     so:=so+Ko*R0A[i]*(COS(R0B[i]+R0C[i]*tau));
     end;  R0:=so;
 {----------------------------------------------------------------------------}
    R1A[1]:=1107433;          R1B[1]:=2.0325052;      R1C[1]:=3340.6124267;
    R1A[2]:= 103176;          R1B[2]:=2.370718;       R1C[2]:=6681.224853;
    R1A[3]:=  12877;          R1B[3]:=0;              R1C[3]:=0;
    R1A[4]:=  10816;          R1B[4]:=2.70888;        R1C[4]:=10021.83728;
    R1A[5]:=   1195;          R1B[5]:=3.0470;         R1C[5]:=13362.4497;
    R1A[6]:=    439;          R1B[6]:=2.888;          R1C[6]:=2281.230;
    R1A[7]:=    396;          R1B[7]:=3.423;          R1C[7]:=3344.136;
    R1A[8]:=    183;          R1B[8]:=1.584;          R1C[8]:=2544.314;
    R1A[9]:=    136;          R1B[9]:=3.385;          R1C[9]:=16703.062;
   R1A[10]:=    128;         R1B[10]:=6.043;         R1C[10]:=3337.089;
   R1A[11]:=    128;         R1B[11]:=0.630;         R1C[11]:=1059.382;
   R1A[12]:=    127;         R1B[12]:=1.954;         R1C[12]:=796.298;
   R1A[13]:=    118;         R1B[13]:=2.998;         R1C[13]:=2146.165;
   R1A[14]:=     88;         R1B[14]:=3.42;          R1C[14]:=398.15;
   R1A[15]:=     83;         R1B[15]:=3.86;          R1C[15]:=3738.76;
   R1A[16]:=     76;         R1B[16]:=4.45;          R1C[16]:=6151.53;
   R1A[17]:=     72;         R1B[17]:=2.76;          R1C[17]:=529.69;
   R1A[18]:=     67;         R1B[18]:=2.55;          R1C[18]:=1751.54;
   R1A[19]:=     66;         R1B[19]:=4.41;          R1C[19]:=1748.02;
   R1A[20]:=     58;         R1B[20]:=0.54;          R1C[20]:=1194.45;
   R1A[21]:=     54;         R1B[21]:=0.68;          R1C[21]:=8962.46;
   R1A[22]:=     51;         R1B[22]:=3.73;          R1C[22]:=6684.75;
   R1A[23]:=     49;         R1B[23]:=5.73;          R1C[23]:=3340.60;
   R1A[24]:=     49;         R1B[24]:=1.48;          R1C[24]:=3340.63;
   R1A[25]:=     48;         R1B[25]:=2.58;          R1C[25]:=3149.16;
   R1A[26]:=     48;         R1B[26]:=2.29;          R1C[26]:=2914.01;
   R1A[27]:=     39;         R1B[27]:=2.32;          R1C[27]:=4136.91;

    so:=0; FOR i:= 1 to R1m do
     begin
     so:=so+Ko*R1A[i]*(COS(R1B[i]+R1C[i]*tau));
     end;  R1:=so;
 {----------------------------------------------------------------------------}
    R2A[1]:=44242;            R2B[1]:=0.47931;        R2C[1]:=3340.61243;
    R2A[2]:= 8138;            R2B[2]:=0.8700;         R2C[2]:=6681.2249;
    R2A[3]:= 1275;            R2B[3]:=1.2259;         R2C[3]:=10021.8373;
    R2A[4]:=  187;            R2B[4]:=1.573;          R2C[4]:=13362.450;
    R2A[5]:=   52;            R2B[5]:=3.14;           R2C[5]:=0;
    R2A[6]:=   41;            R2B[6]:=1.97;           R2C[6]:=3344.14;
    R2A[7]:=   27;            R2B[7]:=1.92;           R2C[7]:=16703.06;
    R2A[8]:=   18;            R2B[8]:=4.43;           R2C[8]:=2281.23;
    R2A[9]:=   12;            R2B[9]:=4.53;           R2C[9]:=3185.19;
   R2A[10]:=   10;           R2B[10]:=5.39;          R2C[10]:=1059.38;
   R2A[11]:=   10;           R2B[11]:=0.42;          R2C[11]:=796.30;

    so:=0; FOR i:= 1 to R2m do
     begin
     so:=so+Ko*R2A[i]*(COS(R2B[i]+R2C[i]*tau));
     end;  R2:=so;
 {----------------------------------------------------------------------------}
    R3A[1]:=1113;             R3B[1]:=5.1499;         R3C[1]:=3340.6124;
    R3A[2]:= 424;             R3B[2]:=5.613;          R3C[2]:=6681.225;
    R3A[3]:= 100;             R3B[3]:=5.997;          R3C[3]:=10021.837;
    R3A[4]:=  20;             R3B[4]:=0.08;           R3C[4]:=13362.45;
    R3A[5]:=   5;             R3B[5]:=3.14;           R3C[5]:=0;
    R3A[6]:=   3;             R3B[6]:=0.43;           R3C[6]:=16703.06;

    so:=0; FOR i:= 1 to R3m do
     begin
     so:=so+Ko*R3A[i]*(COS(R3B[i]+R3C[i]*tau));
     end;  R3:=so;
 {----------------------------------------------------------------------------}
    R4A[1]:=20;               R4B[1]:=3.58;           R4C[1]:=3340.61;
    R4A[2]:=16;               R4B[2]:=4.05;           R4C[2]:=6681.22;
    R4A[3]:= 6;               R4B[3]:=4.46;           R4C[3]:=10021.84;
    R4A[4]:= 2;               R4B[4]:=4.84;           R4C[4]:=13362.45;

    so:=0; FOR i:= 1 to R4m do
     begin
     so:=so+Ko*R4A[i]*(COS(R4B[i]+R4C[i]*tau));
     end;  R4:=so;
 {----------------------------------------------------------------------------}
    R:=(((R4*tau+R3)*tau+R2)*tau+R1)*tau+R0;
    end;

   Procedure MAR(tau:Real;Var L,B,R: Real);
   Begin
      CaricamentoDatiLONG(tau,L,B,R);
      CaricamentoDatiLAT(tau,L,B,R);
      CaricamentoDatiRAGGIO(tau,L,B,R);
    End;

END.
