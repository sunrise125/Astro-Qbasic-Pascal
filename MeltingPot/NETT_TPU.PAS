 Unit NETT_TPU;    {Unit… per Calcolo Nettuno di PRECISIONE}

 Interface

 Uses Crt;
 Const
       Ko=0.00000001; rad=pi/180;
 Var
       i                : Integer;
       tau,so,L,L0,L1,L2,L3,L4,L5,
              B,B0,B1,B2,B3,B4,B5,
              R,R0,R1,R2,R3,R4,R5,
       teta,beta,Xecl,Yecl,Zecl,EPSdata,zita,Z,
       XS,YS,ZS, XS1,YS1,ZS1, XSD,YSD,ZSD  : Real;

   Procedure NET(tau:Real;Var L,B,R: Real);
   Procedure CaricamentoDatiLONG(tau:Real; VAR L,B,R:Real);
   Procedure CaricamentoDatiLAT(tau:Real; VAR L,B,R:Real);
   Procedure CaricamentoDatiRAGGIO(tau:Real; VAR L,B,R:Real);
      Function ArcoTANG(num,den:Real): Real;
      Function ArcoSIN(valore:Real): Real;
      Function MODULO(x,y:Real) : Real;

 Implementation

      Function ArcoTANG(num,den:Real): Real;
    Var atan: Real;
   Begin
     atan:=arctan(num/den);
      if den<0 then atan:=atan+pi;
      if atan<0 then atan:=atan+2*pi;
     ArcoTANG:=atan;
  End;

      Function ArcoSIN(valore:Real): Real;
   Begin
     ArcoSIN:=arctan(valore/SQRT(1-valore*valore));
  End;

      Function MODULO(x,y:Real) : Real;
   Var modu : Real;
   Begin
     modu:=(x/y-INT(x/y))*y;
     MODULO:=modu;
  End;

   Procedure CaricamentoDatiLONG;
Const
       Ku=0.00001;
       l0m=38; l1m=18; l2m=7; l3m=4; l4m=1;
Var
       L0A:           Array[1..l0m] of LongInt;
       L0B,L0C:       Array[1..l0m] of Real;
       L1A:           Array[1..l1m] of Real;
       L1B,L1C:       Array[1..l1m] of Real;
       L2A:           Array[1..l2m] of LongInt;
       L2B,L2C:       Array[1..l2m] of Real;
       L3A:           Array[1..l3m] of Integer;
       L3B,L3C:       Array[1..l3m] of Real;
       L4A:           Array[1..l4m] of Integer;
       L4B,L4C:       Array[1..l4m] of Real;
 begin

    L0A[1]:=531188633;        L0B[1]:=0;              L0C[1]:=0;
    L0A[2]:=  1798476;        L0B[2]:=2.9010127;      L0C[2]:=38.1330356;
    L0A[3]:=  1019728;        L0B[3]:=0.4858092;      L0C[3]:=1.4844727;
    L0A[4]:=   124532;        L0B[4]:=4.830081;       L0C[4]:=36.648563;
    L0A[5]:=    42064;        L0B[5]:=5.41055;        L0C[5]:=2.96895;
    L0A[6]:=    37715;        L0B[6]:=6.09222;        L0C[6]:=35.16409;
    L0A[7]:=    33785;        L0B[7]:=1.24489;        L0C[7]:=76.26607;
    L0A[8]:=    16483;        L0B[8]:=0.00008;        L0C[8]:=491.55793;
    L0A[9]:=     9199;        L0B[9]:=4.9375;         L0C[9]:=39.6175;
   L0A[10]:=     8994;       L0B[10]:=0.2746;        L0C[10]:=175.1661;
   L0A[11]:=     4216;       L0B[11]:=1.9871;        L0C[11]:=73.2971;
   L0A[12]:=     3365;       L0B[12]:=1.0359;        L0C[12]:=33.6796;
   L0A[13]:=     2285;       L0B[13]:=4.2061;        L0C[13]:=4.4534;
   L0A[14]:=     1434;       L0B[14]:=2.7834;        L0C[14]:=74.7816;
   L0A[15]:=      900;       L0B[15]:=2.076;         L0C[15]:=109.946;
   L0A[16]:=      745;       L0B[16]:=3.190;         L0C[16]:=71.813;
   L0A[17]:=      506;       L0B[17]:=5.748;         L0C[17]:=114.399;
   L0A[18]:=      400;       L0B[18]:=0.350;         L0C[18]:=1021.249;
   L0A[19]:=      345;       L0B[19]:=3.462;         L0C[19]:=41.102;
   L0A[20]:=      340;       L0B[20]:=3.304;         L0C[20]:=77.751;
   L0A[21]:=      323;       L0B[21]:=2.248;         L0C[21]:=32.195;
   L0A[22]:=      306;       L0B[22]:=0.497;         L0C[22]:=0.521;
   L0A[23]:=      287;       L0B[23]:=4.505;         L0C[23]:=0.048;
   L0A[24]:=      282;       L0B[24]:=2.246;         L0C[24]:=146.594;
   L0A[25]:=      267;       L0B[25]:=4.889;         L0C[25]:=0.963;
   L0A[26]:=      252;       L0B[26]:=5.782;         L0C[26]:=388.465;
   L0A[27]:=      245;       L0B[27]:=1.247;         L0C[27]:=9.561;
   L0A[28]:=      233;       L0B[28]:=2.505;         L0C[28]:=137.033;
   L0A[29]:=      227;       L0B[29]:=1.797;         L0C[29]:=453.425;
   L0A[30]:=      170;       L0B[30]:=3.324;         L0C[30]:=108.461;
   L0A[31]:=      151;       L0B[31]:=2.192;         L0C[31]:=33.940;
   L0A[32]:=      150;       L0B[32]:=2.997;         L0C[32]:=5.938;
   L0A[33]:=      148;       L0B[33]:=0.859;         L0C[33]:=111.430;
   L0A[34]:=      119;       L0B[34]:=3.677;         L0C[34]:=2.448;
   L0A[35]:=      109;       L0B[35]:=2.416;         L0C[35]:=183.243;
   L0A[36]:=      103;       L0B[36]:=0.041;         L0C[36]:=0.261;
   L0A[37]:=      103;       L0B[37]:=4.404;         L0C[37]:=70.328;
   L0A[38]:=      102;       L0B[38]:=5.705;         L0C[38]:=0.112;

    so:=0; FOR i:= 1 to l0m do
     begin
     so:=so+Ko*L0A[i]*(COS(L0B[i]+L0C[i]*tau));
     end;  L0:=so;
 {----------------------------------------------------------------------------}
    L1A[1]:=3837687.717;      L1B[1]:=0;              L1C[1]:=0;
    L1A[2]:=     16.604;      L1B[2]:=4.86319;        L1C[2]:=1.48447;
    L1A[3]:=     15.807;      L1B[3]:=2.27923;        L1C[3]:=38.13304;
    L1A[4]:=      3.335;      L1B[4]:=3.6820;         L1C[4]:=76.2661;
    L1A[5]:=      1.306;      L1B[5]:=3.6732;         L1C[5]:=2.9689;
    L1A[6]:=      0.605;      L1B[6]:=1.505;          L1C[6]:=35.164;
    L1A[7]:=      0.179;      L1B[7]:=3.453;          L1C[7]:=39.618;
    L1A[8]:=      0.107;      L1B[8]:=2.451;          L1C[8]:=4.453;
    L1A[9]:=      0.106;      L1B[9]:=2.755;          L1C[9]:=33.680;
   L1A[10]:=      0.073;     L1B[10]:=5.49;          L1C[10]:=36.65;
   L1A[11]:=      0.057;     L1B[11]:=1.86;          L1C[11]:=114.40;
   L1A[12]:=      0.057;     L1B[12]:=5.22;          L1C[12]:=0.52;
   L1A[13]:=      0.035;     L1B[13]:=4.52;          L1C[13]:=74.78;
   L1A[14]:=      0.032;     L1B[14]:=5.90;          L1C[14]:=77.75;
   L1A[15]:=      0.030;     L1B[15]:=3.67;          L1C[15]:=388.47;
   L1A[16]:=      0.029;     L1B[16]:=5.17;          L1C[16]:=9.56;
   L1A[17]:=      0.029;     L1B[17]:=5.17;          L1C[17]:=2.45;
   L1A[18]:=      0.026;     L1B[18]:=5.25;          L1C[18]:=168.05;

    so:=0; FOR i:= 1 to l1m do
     begin
     so:=so+Ku*L1A[i]*(COS(L1B[i]+L1C[i]*tau));
     end;  L1:=so;
 {----------------------------------------------------------------------------}
    L2A[1]:=53893;            L2B[1]:=0;              L2C[1]:=0;
    L2A[2]:=  296;            L2B[2]:=1.855;          L2C[2]:=1.484;
    L2A[3]:=  281;            L2B[3]:=1.191;          L2C[3]:=38.133;
    L2A[4]:=  270;            L2B[4]:=5.721;          L2C[4]:=76.266;
    L2A[5]:=   23;            L2B[5]:=1.21;           L2C[5]:=2.97;
    L2A[6]:=    9;            L2B[6]:=4.43;           L2C[6]:=35.16;
    L2A[7]:=    7;            L2B[7]:=0.54;           L2C[7]:=2.45;

    so:=0; FOR i:= 1 to l2m do
     begin
     so:=so+Ko*L2A[i]*(COS(L2B[i]+L2C[i]*tau));
     end;  L2:=so;
 {----------------------------------------------------------------------------}
    L3A[1]:=31;               L3B[1]:=0;              L3C[1]:=0;
    L3A[2]:=15;               L3B[2]:=1.35;           L3C[2]:=76.27;
    L3A[3]:=12;               L3B[3]:=6.04;           L3C[3]:=1.48;
    L3A[4]:=12;               L3B[4]:=6.11;           L3C[4]:=38.13;

    so:=0; FOR i:= 1 to l3m do
     begin
     so:=so+Ko*L3A[i]*(COS(L3B[i]+L3C[i]*tau));
     end;  L3:=so;
 {----------------------------------------------------------------------------}
    L4A[1]:=114;              L4B[1]:=3.142;          L4C[1]:=0;

    so:=0; FOR i:= 1 to l4m do
     begin
     so:=so+Ko*L4A[i]*(COS(L4B[i]+L4C[i]*tau));
     end;  L4:=so;
 {----------------------------------------------------------------------------}

    L:=(((L4*tau+L3)*tau+L2)*tau+L1)*tau+L0;
    end;

   Procedure CaricamentoDatiLAT;
 Const
       b0m=17 ; b1m=13 ; b2m=6 ; b3m=4; b4m=1;
 Var
       B0A:           Array[1..B0m] of LongInt;
       B0B,B0C:       Array[1..B0m] of Real;
       B1A:           Array[1..B1m] of LongInt;
       B1B,B1C:       Array[1..B1m] of Real;
       B2A:           Array[1..B2m] of Integer;
       B2B,B2C:       Array[1..B2m] of Real;
       B3A:           Array[1..B3m] of Integer;
       B3B,B3C:       Array[1..B3m] of Real;
       B4A:           Array[1..B4m] of Integer;
       B4B,B4C:       Array[1..B4m] of Real;

  begin

    B0A[1]:=3088623;          B0B[1]:=1.4410437;      B0C[1]:=38.1330356;
    B0A[2]:=  27780;          B0B[2]:=5.91272;        B0C[2]:=76.26607;
    B0A[3]:=  27624;          B0B[3]:=0;              B0C[3]:=0;
    B0A[4]:=  15448;          B0B[4]:=3.50877;        B0C[4]:=39.61751;
    B0A[5]:=  15355;          B0B[5]:=2.52124;        B0C[5]:=36.64856;
    B0A[6]:=   2000;          B0B[6]:=1.5100;         B0C[6]:=74.7816;
    B0A[7]:=   1968;          B0B[7]:=4.3778;         B0C[7]:=1.4845;
    B0A[8]:=   1015;          B0B[8]:=3.2156;         B0C[8]:=35.1641;
    B0A[9]:=    606;          B0B[9]:=2.802;          B0C[9]:=73.297;
   B0A[10]:=    595;         B0B[10]:=2.129;         B0C[10]:=41.102;
   B0A[11]:=    589;         B0B[11]:=3.187;         B0C[11]:=2.969;
   B0A[12]:=    402;         B0B[12]:=4.169;         B0C[12]:=114.399;
   B0A[13]:=    280;         B0B[13]:=1.682;         B0C[13]:=77.751;
   B0A[14]:=    262;         B0B[14]:=3.767;         B0C[14]:=213.299;
   B0A[15]:=    254;         B0B[15]:=3.271;         B0C[15]:=453.425;
   B0A[16]:=    206;         B0B[16]:=4.257;         B0C[16]:=529.691;
   B0A[17]:=    140;         B0B[17]:=3.530;         B0C[17]:=137.033;

    so:=0; FOR i:= 1 to B0m do
     begin
     so:=so+Ko*B0A[i]*(COS(B0B[i]+B0C[i]*tau));
     end;  B0:=so;
 {----------------------------------------------------------------------------}
    B1A[1]:=227279;           B1B[1]:=3.807931;       B1C[1]:=38.133036;
    B1A[2]:=  1803;           B1B[2]:=1.9758;         B1C[2]:=76.2661;
    B1A[3]:=  1433;           B1B[3]:=3.1416;         B1C[3]:=0;
    B1A[4]:=  1386;           B1B[4]:=4.8256;         B1C[4]:=36.6486;
    B1A[5]:=  1073;           B1B[5]:=6.0805;         B1C[5]:=39.6175;
    B1A[6]:=   148;           B1B[6]:=3.858;          B1C[6]:=74.782;
    B1A[7]:=   136;           B1B[7]:=0.478;          B1C[7]:=1.484;
    B1A[8]:=    70;           B1B[8]:=6.19;           B1C[8]:=35.16;
    B1A[9]:=    52;           B1B[9]:=5.05;           B1C[9]:=73.30;
   B1A[10]:=    43;          B1B[10]:=0.31;          B1C[10]:=114.40;
   B1A[11]:=    37;          B1B[11]:=4.89;          B1C[11]:=41.10;
   B1A[12]:=    37;          B1B[12]:=5.76;          B1C[12]:=2.97;
   B1A[13]:=    26;          B1B[13]:=5.22;          B1C[13]:=213.30;

    so:=0; FOR i:= 1 to B1m do
     begin
     so:=so+Ko*B1A[i]*(COS(B1B[i]+B1C[i]*tau));
     end;  B1:=so;
 {----------------------------------------------------------------------------}
    B2A[1]:=9691;             B2B[1]:=5.5712;         B2C[1]:=38.1330;
    B2A[2]:=  79;             B2B[2]:=3.63;           B2C[2]:=76.27;
    B2A[3]:=  72;             B2B[3]:=0.45;           B2C[3]:=36.65;
    B2A[4]:=  59;             B2B[4]:=3.14;           B2C[4]:=0;
    B2A[5]:=  30;             B2B[5]:=1.61;           B2C[5]:=39.62;
    B2A[6]:=   6;             B2B[6]:=5.61;           B2C[6]:=74.78;

    so:=0; FOR i:= 1 to B2m do
     begin
     so:=so+Ko*B2A[i]*(COS(B2B[i]+B2C[i]*tau));
     end;  B2:=so;
 {----------------------------------------------------------------------------}
    B3A[1]:=273;              B3B[1]:=1.017;          B3C[1]:=38.133;
    B3A[2]:=  2;              B3B[2]:=0;              B3C[2]:=0;
    B3A[3]:=  2;              B3B[3]:=2.37;           B3C[3]:=36.65;
    B3A[4]:=  2;              B3B[4]:=5.33;           B3C[4]:=76.27;

    so:=0; FOR i:= 1 to B3m do
     begin
     so:=so+Ko*B3A[i]*(COS(B3B[i]+B3C[i]*tau));
     end;  B3:=so;
 {----------------------------------------------------------------------------}
    B4A[1]:=6;                B4B[1]:=2.67;           B4C[1]:=38.13;

    so:=0; FOR i:= 1 to B4m do
     begin
     so:=so+Ko*B4A[i]*(COS(B4B[i]+B4C[i]*tau));
     end;  B4:=so;
 {----------------------------------------------------------------------------}

    B:=(((B4*tau+B3)*tau+B2)*tau+B1)*tau+B0;
    end;


   Procedure CaricamentoDatiRAGGIO;
 Const
       Ku=0.00001;
       r0m=32; r1m=15; r2m=5 ; r3m=1;
 Var
       R0A:           Array[1..R0m] of Real;
       R0B,R0C:       Array[1..R0m] of Real;
       R1A:           Array[1..R1m] of LongInt;
       R1B,R1C:       Array[1..R1m] of Real;
       R2A:           Array[1..R2m] of Integer;
       R2B,R2C:       Array[1..R2m] of Real;
       R3A:           Array[1..R3m] of Integer;
       R3B,R3C:       Array[1..R3m] of Real;

    begin

    R0A[1]:=3007013.206;      R0B[1]:=0;              R0C[1]:=0;
    R0A[2]:=  27062.259;      R0B[2]:=1.32999459;     R0C[2]:=38.13303564;
    R0A[3]:=   1691.764;      R0B[3]:=3.2518614;      R0C[3]:=36.6485629;
    R0A[4]:=    807.831;      R0B[4]:=5.185928;       R0C[4]:=1.484473;
    R0A[5]:=    537.761;      R0B[5]:=4.521139;       R0C[5]:=35.164090;
    R0A[6]:=    495.726;      R0B[6]:=1.571057;       R0C[6]:=491.557929;
    R0A[7]:=    274.572;      R0B[7]:=1.845523;       R0C[7]:=175.166060;
    R0A[8]:=    135.134;      R0B[8]:=3.372206;       R0C[8]:=39.617508;
    R0A[9]:=    121.802;      R0B[9]:=5.797544;       R0C[9]:=76.266071;
   R0A[10]:=    100.895;     R0B[10]:=0.377027;      R0C[10]:=73.297126;
   R0A[11]:=     69.792;     R0B[11]:=3.79617;       R0C[11]:=2.96895;
   R0A[12]:=     46.688;     R0B[12]:=5.74938;       R0C[12]:=33.67962;
   R0A[13]:=     24.594;     R0B[13]:=0.50802;       R0C[13]:=109.94569;
   R0A[14]:=     16.939;     R0B[14]:=1.59422;       R0C[14]:=71.81265;
   R0A[15]:=     14.230;     R0B[15]:=1.07786;       R0C[15]:=74.78160;
   R0A[16]:=     12.012;     R0B[16]:=1.92062;       R0C[16]:=1021.24889;
   R0A[17]:=      8.395;     R0B[17]:=0.6782;        R0C[17]:=146.5943;
   R0A[18]:=      7.572;     R0B[18]:=1.0715;        R0C[18]:=388.4652;
   R0A[19]:=      5.721;     R0B[19]:=2.5906;        R0C[19]:=4.4534;
   R0A[20]:=      4.840;     R0B[20]:=1.9069;        R0C[20]:=41.1020;
   R0A[21]:=      4.483;     R0B[21]:=2.9057;        R0C[21]:=529.6910;
   R0A[22]:=      4.421;     R0B[22]:=1.7499;        R0C[22]:=108.4612;
   R0A[23]:=      4.354;     R0B[23]:=0.6799;        R0C[23]:=32.1951;
   R0A[24]:=      4.270;     R0B[24]:=3.1434;        R0C[24]:=453.4249;
   R0A[25]:=      3.381;     R0B[25]:=0.8481;        R0C[25]:=183.2428;
   R0A[26]:=      2.881;     R0B[26]:=1.9860;        R0C[26]:=137.0330;
   R0A[27]:=      2.879;     R0B[27]:=3.6742;        R0C[27]:=350.3321;
   R0A[28]:=      2.636;     R0B[28]:=3.0976;        R0C[28]:=213.2991;
   R0A[29]:=      2.530;     R0B[29]:=5.7984;        R0C[29]:=490.0735;
   R0A[30]:=      2.523;     R0B[30]:=0.4863;        R0C[30]:=493.0424;
   R0A[31]:=      2.306;     R0B[31]:=2.8096;        R0C[31]:=70.3282;
   R0A[32]:=      2.087;     R0B[32]:=0.6186;        R0C[32]:=33.9402;

    so:=0; FOR i:= 1 to R0m do
     begin
     so:=so+Ku*R0A[i]*(COS(R0B[i]+R0C[i]*tau));
     end;  R0:=so;
 {----------------------------------------------------------------------------}
    R1A[1]:=236339;           R1B[1]:=0.704980;       R1C[1]:=38.133036;
    R1A[2]:= 13220;           R1B[2]:=3.32015;        R1C[2]:=1.48447;
    R1A[3]:=  8622;           R1B[3]:=6.2163;         R1C[3]:=35.1641;
    R1A[4]:=  2702;           R1B[4]:=1.8814;         R1C[4]:=39.6175;
    R1A[5]:=  2155;           R1B[5]:=2.0943;         R1C[5]:=2.9689;
    R1A[6]:=  2153;           R1B[6]:=5.1687;         R1C[6]:=76.2661;
    R1A[7]:=  1603;           R1B[7]:=0;              R1C[7]:=0;
    R1A[8]:=  1464;           R1B[8]:=1.1842;         R1C[8]:=33.6796;
    R1A[9]:=  1136;           R1B[9]:=3.9189;         R1C[9]:=36.6486;
   R1A[10]:=   898;          R1B[10]:=5.241;         R1C[10]:=388.465;
   R1A[11]:=   790;          R1B[11]:=0.533;         R1C[11]:=168.053;
   R1A[12]:=   760;          R1B[12]:=0.021;         R1C[12]:=182.280;
   R1A[13]:=   607;          R1B[13]:=1.077;         R1C[13]:=1021.249;
   R1A[14]:=   572;          R1B[14]:=3.401;         R1C[14]:=484.444;
   R1A[15]:=   561;          R1B[15]:=2.887;         R1C[15]:=498.671;

    so:=0; FOR i:= 1 to R1m do
     begin
     so:=so+Ko*R1A[i]*(COS(R1B[i]+R1C[i]*tau));
     end;  R1:=so;
 {----------------------------------------------------------------------------}
    R2A[1]:=4247;             R2B[1]:=5.8991;         R2C[1]:=38.1330;
    R2A[2]:= 218;             R2B[2]:=0.346;          R2C[2]:=1.484;
    R2A[3]:= 163;             R2B[3]:=2.239;          R2C[3]:=168.053;
    R2A[4]:= 156;             R2B[4]:=4.594;          R2C[4]:=182.280;
    R2A[5]:= 127;             R2B[5]:=2.848;          R2C[5]:=35.164;

    so:=0; FOR i:= 1 to R2m do
     begin
     so:=so+Ko*R2A[i]*(COS(R2B[i]+R2C[i]*tau));
     end;  R2:=so;
 {----------------------------------------------------------------------------}
    R3A[1]:=166;              R3B[1]:=4.552;          R3C[1]:=38.133;

    so:=0; FOR i:= 1 to R3m do
     begin
     so:=so+Ko*R3A[i]*(COS(R3B[i]+R3C[i]*tau));
     end;  R3:=so;
 {----------------------------------------------------------------------------}
    R:=((R3*tau+R2)*tau+R1)*tau+R0;
    end;

   Procedure NET(tau:Real;Var L,B,R: Real);
   Begin
      CaricamentoDatiLONG(tau,L,B,R);
      CaricamentoDatiLAT(tau,L,B,R);
      CaricamentoDatiRAGGIO(tau,L,B,R);
    End;

END.
